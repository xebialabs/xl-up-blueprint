apiVersion: xl-deploy/v1
kind: Applications
spec:
  - directory: Applications/XEBIALABS
    children:
      - directory: XL-DEPLOY
        children:
          - name: XL-Deploy-Deployment
            type: udm.Application
            children:
              {{if  .useCustomRegistry }}
              - name: "{{.xldTag}}"
              {{ else }}
              - name: "{{.xlVersion}}"
              {{ end }}
                type: udm.DeploymentPackage
                orchestrator:
                  - sequential-by-dependency
                deployables:
                {{- if  eq .K8sSetup "Local K8s from Docker Desktop for Mac/Windows" }}
                  - name: xld-deployment
                    type: k8s.ResourcesFile
                    file: !file kubernetes/xl-deploy/local-db/xld-deployment-single-node.yaml
                  {{- else }}
                  - name: xld-deployment-master
                    type: k8s.ResourcesFile
                    file: !file kubernetes/xl-deploy/external-db/active-active/xld-deployment-master.yaml
                  - name: xld-deployment-worker
                    type: k8s.ResourcesFile
                    file: !file kubernetes/xl-deploy/external-db/active-active/xld-deployment-worker.yaml
                  - name: xld-work-pvc
                    type: k8s.ResourcesFile
                    file: !file kubernetes/xl-deploy/external-db/active-active/work-pvc.yaml
                  - name: xld-export-pvc
                    type: k8s.ResourcesFile
                    file: !file kubernetes/xl-deploy/external-db/active-active/export-pvc.yaml
                  {{- end}}
                applicationDependencies: null
                undeployDependencies: "true"
